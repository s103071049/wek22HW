(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{26:function(e,t,n){"use strict";n.r(t);var c,a,i,r,o=n(0),s=n.n(o),j=n(13),b=n.n(j),d=n(5),u=n(3),l=n(4),O="token",p=function(e){localStorage.setItem(O,e)},x=function(){return localStorage.getItem(O)},h="https://student-json-api.lidemy.me",f=function(){var e=x();return fetch("".concat(h,"/me"),{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))},g=n(2),m=Object(o.createContext)(null),v=n(1),y=l.a.form(c||(c=Object(u.a)(["\n  width: 40%;\n  margin: 0 auto;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border: 1px solid #333;\n  padding: 12px;\n  margin-top: 24px;\n  flex-direction: column;\n"]))),S=l.a.div(a||(a=Object(u.a)(["\n  padding: 12px;\n"]))),w=l.a.button(i||(i=Object(u.a)(["\n  background: #3m3m3m;\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  text-align: center;\n"]))),k=l.a.div(r||(r=Object(u.a)(["\n  color: red;\n"])));function C(){var e=Object(o.useContext)(m).setUser,t=Object(o.useState)(""),n=Object(d.a)(t,2),c=n[0],a=n[1],i=Object(o.useState)(""),r=Object(d.a)(i,2),s=r[0],j=r[1],b=Object(o.useState)(""),u=Object(d.a)(b,2),l=u[0],O=u[1],x=Object(g.f)();return Object(v.jsxs)(y,{onSubmit:function(t){t.preventDefault(),O(""),function(e,t){return fetch("".concat(h,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:e,password:t})}).then((function(e){return e.json()}))}(c,s).then((function(t){if(0===t.ok)return O(t.message);p(t.token),f().then((function(t){if(1!==t.ok)return p(null),O("\u7cfb\u7d71\u8655\u7406\u7570\u5e38\uff0c\u8acb\u8acb\u7a0d\u5f8c\u518d\u5617\u8a66");e(t.data),x("/")}))}))},children:[Object(v.jsxs)(S,{children:["username:"," ",Object(v.jsx)("input",{value:c,onChange:function(e){return a(e.target.value)}})]}),Object(v.jsxs)(S,{children:["password:"," ",Object(v.jsx)("input",{type:"password",value:s,onChange:function(e){j(e.target.value)}})]}),l&&Object(v.jsx)(k,{children:l}),Object(v.jsx)(w,{children:"\u767b\u5165"})]})}var z,F,D,P,$,J,T,B,E,I=n(7),U=l.a.div(z||(z=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]))),L=l.a.div(F||(F=Object(u.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n"]))),N=Object(l.a)(I.b)(D||(D=Object(u.a)(["\n  font-size: 16px;\n  color: black;\n  text-decoration: none;\n"]))),A=l.a.div(P||(P=Object(u.a)(["\n  color: rgba(0, 0, 0.8);\n"]))),M=l.a.div($||($=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n  padding-top: 12px;\n"]))),_=l.a.span(J||(J=Object(u.a)(["\n  padding: 6px;\n"])));function q(e){var t=e.post;return Object(v.jsxs)(L,{children:[Object(v.jsx)(N,{to:"/posts/".concat(t.id),children:t.title}),Object(v.jsx)(A,{children:new Date(t.createdAt).toLocaleDateString()})]})}function G(){var e=Object(o.useState)(1),t=Object(d.a)(e,2),n=t[0],c=t[1],a=Object(o.useState)(1),i=Object(d.a)(a,2),r=i[0],s=i[1],j=Object(o.useState)([]),b=Object(d.a)(j,2),u=b[0],l=b[1],O=5*(n-1);return Object(o.useEffect)((function(){fetch("".concat(h,"/posts?_sort=createdAt&_order=desc")).then((function(e){return e.json()})).then((function(e){l(e),s(Math.ceil(e.length/5))}))}),[]),Object(v.jsxs)(U,{children:[u.slice(O,O+5).map((function(e){return Object(v.jsx)(q,{post:e},e.id)})),Object(v.jsxs)(M,{children:[1!==n&&Object(v.jsx)(_,{onClick:function(e){c(1)},children:"\u6700\u524d\u9801"}),1!==n&&Object(v.jsx)(_,{onClick:function(e){c(n-1)},children:"<"}),Object(v.jsx)(_,{children:n}),n!==r&&Object(v.jsx)(_,{onClick:function(e){c(n+1)},children:">"}),n!==r&&Object(v.jsx)(_,{onClick:function(e){c(r)},children:"\u6700\u672b\u9801"})]})]})}var H,K,Q,R,V=l.a.div(T||(T=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  padding: 12px;\n  margin: 0 auto;\n  width: 80%;\n"]))),W=l.a.div(B||(B=Object(u.a)(["\n  font-size: 24px;\n"]))),X=l.a.div(E||(E=Object(u.a)(["\n  padding: 12px;\n  line-height: 1.5em;\n  white-space: break-spaces;\n"])));function Y(){var e=Object(g.g)(),t=Object(o.useState)(""),n=Object(d.a)(t,2),c=n[0],a=n[1];return Object(o.useEffect)((function(){var t;(t=e.id,fetch("".concat(h,"/posts?id=").concat(t)).then((function(e){return e.json()}))).then((function(e){return a(e)}))}),[]),Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(V,{children:[c&&Object(v.jsx)(W,{children:c[0].title}),c&&Object(v.jsx)(X,{children:c[0].body})]})})}var Z,ee=l.a.form(H||(H=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n  padding: 12px;\n"]))),te=l.a.div(K||(K=Object(u.a)(["\n  padding: 12px;\n"]))),ne=l.a.button(Q||(Q=Object(u.a)(["\n  background: white;\n  border: 1px solid gray;\n  padding: 12px;\n  width: 80px;\n  cursor: pointer;\n"]))),ce=l.a.div(R||(R=Object(u.a)(["\n  color: red;\n  font-size: 24px;\n"])));function ae(){var e=Object(o.useState)(""),t=Object(d.a)(e,2),n=t[0],c=t[1],a=Object(o.useState)(""),i=Object(d.a)(a,2),r=i[0],s=i[1],j=Object(o.useState)(""),b=Object(d.a)(j,2),u=b[0],l=b[1],O=Object(g.f)();return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(ee,{onSubmit:function(e){e.preventDefault(),l(""),function(e,t){var n=x();return fetch("".concat(h,"/posts"),{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer ".concat(n)},body:JSON.stringify({title:e,body:t})}).then((function(e){return e.json()}))}(n,r).then((function(e){if(0===e.ok)return l(e.message);O("/")}))},children:[u&&Object(v.jsx)(ce,{children:u}),"\u8f38\u5165\u6587\u7ae0\u6a19\u984c\uff1a",Object(v.jsx)(te,{children:Object(v.jsx)("input",{type:"text",value:n,onChange:function(e){c(e.target.value)}})}),"\u8f38\u5165\u6587\u7ae0\u5167\u5bb9\uff1a",Object(v.jsx)(te,{children:Object(v.jsx)("textarea",{style:{width:"500px",height:"400px"},value:r,onChange:function(e){return s(e.target.value)}})}),Object(v.jsx)(ne,{children:"\u63d0\u4ea4"})]})})}var ie,re,oe,se,je=l.a.div(Z||(Z=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n  white-space: pre;\n  margin-top: 24px;\n"])));function be(){return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(je,{children:"\u55e8\u55e8\uff0c\n        \u9019\u88e1\u662f\u88ab react final project\u803d\u8aa4\u7684\u4f5c\u696d\u3002\n        \u6211\u7684\u76ee\u6a19\u662f\u5728\u4e00\u908a\u6e96\u5099\u6c42\u8077\uff0c\u4e00\u908a\u628a\u4f5c\u696d\u8207 redux \u641e\u5b9a\u3002\n        \u81ea\u5df1\u9084\u6709\u597d\u591a\u4e0d\u8db3\uff0c\u9019\u6a23\u771f\u7684\u6c92\u6709\u554f\u984c\u9ebb\uff1f\u4e0d\u904e\uff0c\u7169\u60f1\u9019\u9ebc\u591a\u597d\u50cf\u4e5f\u6c92\u6709\u751a\u9ebc\u5e6b\u52a9\u3002\u53ea\u8981\u5fc3\u614b\u6b63\u78ba\u5269\u4e0b\u7684\u5c31\u53ea\u662f\u6642\u9593\u554f\u984c\uff0c\u6240\u4ee5\u7e7c\u7e8c\u52aa\u529b\u3002"})})}var de,ue,le,Oe,pe,xe=l.a.form(ie||(ie=Object(u.a)(["\n  width: 40%;\n  margin: 0 auto;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border: 1px solid #333;\n  padding: 12px;\n  margin-top: 24px;\n  flex-direction: column;\n"]))),he=l.a.div(re||(re=Object(u.a)(["\n  padding: 12px;\n"]))),fe=l.a.button(oe||(oe=Object(u.a)(["\n  background: #3m3m3m;\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  text-align: center;\n"]))),ge=l.a.div(se||(se=Object(u.a)(["\n  color: red;\n"])));function me(){var e=Object(o.useContext)(m).setUser,t=Object(o.useState)(""),n=Object(d.a)(t,2),c=n[0],a=n[1],i=Object(o.useState)(""),r=Object(d.a)(i,2),s=r[0],j=r[1],b=Object(o.useState)(""),u=Object(d.a)(b,2),l=u[0],O=u[1],x=Object(o.useState)(""),y=Object(d.a)(x,2),S=y[0],w=y[1],k=Object(g.f)();return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(xe,{onSubmit:function(t){t.preventDefault(),w(""),function(e,t,n){return fetch("".concat(h,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:t,username:e,password:n})}).then((function(e){return e.json()}))}(c,l,s).then((function(t){if(1!==t.ok)return w(t.message);p(t.token),f().then((function(t){if(1!==t.ok)return p(null),w("\u7cfb\u7d71\u8655\u7406\u7570\u5e38\uff0c\u8acb\u8acb\u7a0d\u5f8c\u518d\u5617\u8a66");e(t.data),k("/")}))}))},children:[Object(v.jsxs)(he,{children:["username:"," ",Object(v.jsx)("input",{value:c,onChange:function(e){return a(e.target.value)}})]}),Object(v.jsxs)(he,{children:["nickname:"," ",Object(v.jsx)("input",{value:l,onChange:function(e){O(e.target.value)}})]}),Object(v.jsxs)(he,{children:["password:"," ",Object(v.jsx)("input",{type:"password",value:s,onChange:function(e){j(e.target.value)}})]}),S&&Object(v.jsx)(ge,{children:S}),Object(v.jsx)(fe,{children:"\u63d0\u4ea4"})]})})}var ve,ye=l.a.div(de||(de=Object(u.a)(["\n  height: 64px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.4);\n  padding: 0 32px;\n  box-sizing: border-box;\n"]))),Se=l.a.div(ue||(ue=Object(u.a)(["\n  font-size: 32px;\n  font-weight: bold;\n"]))),we=l.a.div(le||(le=Object(u.a)(["\n  display: flex;\n  align-items: center;\n  height: 64px;\n"]))),ke=Object(l.a)(I.b)(Oe||(Oe=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n  box-sizing: border-box;\n  ","\n"])),(function(e){return e.$active&&"\n    background: rgba(0, 0, 0, 0.1);\n  "})),Ce=l.a.div(pe||(pe=Object(u.a)(["\n  display: flex;\n  align-items: center;\n  "," {\n    margin-left: 64px;\n  }\n"])),we);function ze(){var e=Object(g.e)(),t=Object(o.useContext)(m),n=t.user,c=t.setUser;return Object(v.jsxs)(ye,{children:[Object(v.jsxs)(Ce,{children:[Object(v.jsx)(Se,{children:"\u6211\u7684\u7b2c\u4e00\u500b\u90e8\u843d\u683c"}),Object(v.jsxs)(we,{children:[Object(v.jsx)(ke,{$active:"/"===e.pathname,to:"/",children:"\u9996\u9801"}),n&&Object(v.jsx)(ke,{$active:"/new-post"===e.pathname,to:"/new-post",children:"\u767c\u5e03\u6587\u7ae0"}),Object(v.jsx)(ke,{$active:"/about"===e.pathname,to:"/about",children:"\u95dc\u65bc\u6211\u5011"})]})]}),Object(v.jsxs)(we,{children:[!n&&Object(v.jsx)(ke,{$active:"/login"===e.pathname,to:"/login",children:"\u767b\u5165"}),!n&&Object(v.jsx)(ke,{$active:"/register"===e.pathname,to:"/register",children:"\u8a3b\u518a"}),n&&Object(v.jsx)(ke,{onClick:function(){p(""),c(null)},to:"/",children:"\u767b\u51fa"})]})]})}var Fe=l.a.div(ve||(ve=Object(u.a)(["\n  padding-top: 64px;\n"])));var De=function(){var e=Object(o.useState)(null),t=Object(d.a)(e,2),n=t[0],c=t[1],a=x();return Object(o.useEffect)((function(){a&&f().then((function(e){e.ok&&c(e.data)}))}),[a]),Object(v.jsx)(m.Provider,{value:{user:n,setUser:c},children:Object(v.jsx)(Fe,{children:Object(v.jsxs)(I.a,{children:[Object(v.jsx)(ze,{}),Object(v.jsxs)(g.c,{children:[Object(v.jsx)(g.a,{exact:!0,path:"/",element:Object(v.jsx)(G,{})}),Object(v.jsx)(g.a,{path:"/login",element:Object(v.jsx)(C,{})}),Object(v.jsx)(g.a,{path:"/register",element:Object(v.jsx)(me,{})}),Object(v.jsx)(g.a,{path:"/posts/:id",element:Object(v.jsx)(Y,{})}),Object(v.jsx)(g.a,{path:"/about",element:Object(v.jsx)(be,{})}),n&&Object(v.jsx)(g.a,{path:"/new-post",element:Object(v.jsx)(ae,{})})]})]})})})},Pe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,27)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),i(e),r(e)}))};b.a.render(Object(v.jsx)(s.a.StrictMode,{children:Object(v.jsx)(De,{})}),document.getElementById("root")),Pe()}},[[26,1,2]]]);
//# sourceMappingURL=main.6b6f5c9f.chunk.js.map